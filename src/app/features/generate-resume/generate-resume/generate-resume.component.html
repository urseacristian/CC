<div class="generate-resume-container">
  <mat-card class="resume-card">
    <mat-card-header>
      <mat-card-title>Generare CV</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="resumeForm" (ngSubmit)="onSubmit()">
        <mat-form-field appearance="outline">
          <mat-label>Nume</mat-label>
          <input matInput formControlName="lastName" required />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Prenume</mat-label>
          <input matInput formControlName="firstName" required />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Locație</mat-label>
          <input matInput formControlName="location" required />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input matInput formControlName="email" required />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Telefon</mat-label>
          <input matInput formControlName="phone" required />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Rezumat Profesional</mat-label>
          <textarea matInput formControlName="summary"></textarea>
        </mat-form-field>

        <div formArrayName="skills">
          <label>Abilități:</label>
          <div *ngFor="let skill of skills.controls; let i = index" [formGroupName]="i">
            <mat-form-field appearance="outline">
              <mat-label>Abilitate {{ i + 1 }}</mat-label>
              <input matInput formControlName="skill" />
            </mat-form-field>
            <button mat-icon-button color="warn" (click)="removeSkill(i)" *ngIf="skills.length > 1">
              <mat-icon>remove_circle</mat-icon>
            </button>
          </div>
          <button mat-button color="primary" (click)="addSkill()">Adaugă Abilitate</button>
        </div>

        <div formArrayName="experiences">
          <label>Experiență Profesională:</label>
          <div *ngFor="let experience of experiences.controls; let i = index" [formGroupName]="i">
            <mat-form-field appearance="outline">
              <mat-label>Titlu Job</mat-label>
              <input matInput formControlName="jobTitle" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Companie</mat-label>
              <input matInput formControlName="company" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Data Începerii</mat-label>
              <input matInput formControlName="startDate" type="date" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Data Încheierii</mat-label>
              <input matInput formControlName="endDate" type="date" />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Responsabilități</mat-label>
              <textarea matInput formControlName="responsibilities"></textarea>
            </mat-form-field>

            <button mat-icon-button color="warn" (click)="removeExperience(i)" *ngIf="experiences.length > 1">
              <mat-icon>remove_circle</mat-icon>
            </button>
          </div>
          <button mat-button color="primary" (click)="addExperience()">Adaugă Experiență</button>
        </div>

        <div formArrayName="educations">
          <label>Educație:</label>
          <div *ngFor="let education of educations.controls; let i = index" [formGroupName]="i">
            <mat-form-field appearance="outline">
              <mat-label>Instituție</mat-label>
              <input matInput formControlName="institution" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Diplomă</mat-label>
              <input matInput formControlName="degree" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Domeniu de Studiu</mat-label>
              <input matInput formControlName="fieldOfStudy" />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Data Începerii</mat-label>
              <input matInput formControlName="startDate" type="date" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Data Încheierii</mat-label>
              <input matInput formControlName="endDate" type="date" />
            </mat-form-field>

            <button mat-icon-button color="warn" (click)="removeEducation(i)" *ngIf="educations.length > 1">
              <mat-icon>remove_circle</mat-icon>
            </button>
          </div>
          <button mat-button color="primary" (click)="addEducation()">Adaugă Educație</button>
        </div>

        <div formArrayName="courses">
          <label>Cursuri:</label>
          <div *ngFor="let course of courses.controls; let i = index" [formGroupName]="i">
            <mat-form-field appearance="outline">
              <mat-label>Denumire Curs</mat-label>
              <input matInput formControlName="courseName" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Instituție</mat-label>
              <input matInput formControlName="institution" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Data Absolvirii</mat-label>
              <input matInput formControlName="completionDate" type="date" />
            </mat-form-field>

            <button mat-icon-button color="warn" (click)="removeCourse(i)" *ngIf="courses.length > 1">
              <mat-icon>remove_circle</mat-icon>
            </button>
          </div>
          <button mat-button color="primary" (click)="addCourse()">Adaugă Curs</button>
        </div>

        <div *ngIf="isLoading" class="progress-bar-container">
          <mat-progress-bar mode="indeterminate"></mat-progress-bar>
        </div>

        <button mat-raised-button color="primary" type="submit" [disabled]="resumeForm.invalid || isLoading">
          Generează CV
        </button>
      </form>
      <button mat-stroked-button color="accent" class="back-button" (click)="goBack()">
        Înapoi la Home
      </button>
    </mat-card-content>
  </mat-card>
</div>
